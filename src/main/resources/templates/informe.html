<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
    <head th:replace="plantillas/plantilla::head">
        <meta charset="UTF-8"/>
    </head>

    <!-- Bootstrap JS and dependencies -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">


        <!-- Bootstrap CSS -->
        <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
            <!-- jQuery -->
            <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
            <!-- jQuery UI CSS -->
            <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
                <!-- jQuery UI JS -->
                <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
                <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
                    <style>

                        /* CSS personalizado para el popover */
                        .popover-body {
                            color: #fff; /* Cambiar el color del texto */
                            background-color: #007bff; /* Cambiar el fondo */
                        }

                        .popover {
                            max-width: 500px; /* Ensanchar el popover */
                        }
                        .titulo{
                             font-weight: bold;
                        }
                        
                        
                        
                        
                    </style>

                    <body>
                        <!--para que funcione el popover-->
                        <script>

//para cerrar el popover al hacer clic fuera
                            $(function () {
                                $('[data-toggle="popover"]').popover({
                                    trigger: 'focus' // Permitir cerrar al hacer clic fuera
                                });
                            });

                        </script>
                        <header th:replace="plantillas/plantilla::header"></header>
                        <!--        <div class="modal-dialog" style="position: fixed; top: 50px; right: 20px; z-index: 1030;">
                                    Serás redirigido en: <span id="tiempoRestante">60</span> segundos
                                </div>-->

                        <body>
                            <div class="container mt-5">
                                <h1 class="mb-4" style="text-align: center">Informe</h1>
                               <form th:action="@{/guardarInforme}" method="post" th:object="${tarea.informe}" enctype="multipart/form-data" class="">
                                    <input type="hidden"  id="id" th:field="*{id}"  >
                                    <input type="hidden"  id="url" th:field="${url}"  >
                                <h4 class="mb-4">Datos intervencion </h4>
                                    
<!--                                    <div class="form-row">
                                        <label for="acercaDeMi">Acerca de mi</label>&nbsp;&nbsp;<span><i class="fa-regular fa-circle-question custom-popover" tabindex="0" data-container="body" data-trigger="focus"data-toggle="popover"data-placement="right" data-content="Breve carta de presentación, por ejemplo:'soy técnico mecánico con [número] años de experiencia en el mantenimiento y reparación de maquinaria industrial. Me especializo en el diagnóstico y solución de problemas mecánicos, así como en la implementación de programas de mantenimiento preventivo.' "></i></span>
                                    </div> 

                                    <textarea class="form-control" id="acercaDeMi" th:field="*{acercaDeMi}"></textarea>   -->

                                    <div class="form-row">
                                        <div class="form-group col-md-6">
                                            <label class="titulo">Activo</label>
                                            <input type="text" class="form-control" id="activo"th:field="${tarea.activo.nombre}" readonly="true" >
                                        </div>
                                        <div class="form-group col-md-6">
                                            <label class="titulo">Categoría</label>
                                            <input type="text" class="form-control" id="categoria"th:field="${tarea.categoriaTecnica}"  readonly="true" >
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="card bg-light col-md-6">
                                             <div class="row  card-body ">
                                                 <div class="col-4">
                                                    <label class="titulo"  >Interventores: </label>
                                                 </div>
                                                 <div class="col-8">
                                                    <div th:each="asignacion : ${tarea.asignaciones}">
                                                        <div th:text="${asignacion.tecnico.apellido} + ' ' + ${asignacion.tecnico.nombre}">
                                                        </div>
                                                    </div>
                                                 </div>
                                             </div>    
                                        </div>
                                        
                                        <div class="form-group col-md-6">
<!--                                            <label for="especialidad">Edad</label>
                                            <input type="text" class="form-control" id="edad"th:field="*{edad}" disabled="true">-->
                                        </div>
                                    </div>
                                    <br>

                                    <div class="form-row">
<!--                                        <div class="form-group col-md-6">
                                            <label for="telefono">Teléfono</label>
                                            <input type="text" class="form-control" id="telefono"th:field="*{telefono}">
                                        </div>
                                        <div class="form-group col-md-6">
                                            <label for="email">email</label>
                                            <input type="email" class="form-control" id="email"th:field="*{email}">
                                        </div>-->
                                   <div class="form-row">
                                       <label class="titulo">Descripción inicial del solicitador: </label>&nbsp;<span class="titulo" th:text="${tarea.solicita}"></span>&nbsp;&nbsp;<span><i class="fa-regular fa-circle-question custom-popover" tabindex="0" data-container="body" data-trigger="focus"data-toggle="popover"data-placement="right" data-content="descripción inicial del cliente interno al momento de dar aviso de la detención del activo"></i></span>
                                    </div> 

                                    <textarea class="form-control" id="descripciónInicial" th:field="${tarea.descripcion}"readonly="true"></textarea>   
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group col-md-6">
                                            <label class="titulo">Departamento responsable</label>
                                            <input type="text" class="form-control" id="responsable"th:field="${tarea.departamentoResponsable}"readonly="true">
                                        </div>

                                    </div>

                                    <div class="form-row">
                                        <div class="form-group col-md-6">
                                            <label class="titulo">Tiempo detenido</label>&nbsp;&nbsp;<span><i class="fa-regular fa-circle-question custom-popover" tabindex="0" data-container="body" data-trigger="focus"data-toggle="popover"data-placement="right" data-content="Tiempo total de activo detenido hasta su liberación"></i></span>
                                           <input type="text" class="form-control" id="tiempoDetenido" th:value="${tiempoDetenido}"readonly="true">
                                        </div>
                                    </div>
                                    

                                    <br>
                                        <h4 class="mt-4">Informe</h4>
                                        <div class="form-row">
                                            <label for="descripcionInforme">Descripción</label>&nbsp;&nbsp;<span><i class="fa-regular fa-circle-question custom-popover" tabindex="0" data-container="body" data-trigger="focus"data-toggle="popover"data-placement="right" data-content="descripción del problema desde el punto de vista del interventor "></i></span>
                                        </div> 

                                        <textarea class="form-control" id="descripcionInforme" th:field="*{descripcion}"></textarea>
                                        
                                        <div class="form-row">
                                            <label for="acciones">Acciones</label>&nbsp;&nbsp;<span><i class="fa-solid fa-circle-exclamation custom-popover" tabindex="0" data-container="body" data-trigger="focus"data-toggle="popover"data-placement="right" data-content="acciones para la resolución, este campo es muy importante, intente ser claro y objetivo' "></i></span>
                                        </div> 

                                        <textarea class="form-control" id="acciones" th:field="*{acciones}"></textarea>
                                        
                                        <div class="form-row">
                                            <label for="pruebas">Pruebas realizadas</label>&nbsp;&nbsp;<span><i class="fa-regular fa-circle-question custom-popover" tabindex="0" data-container="body" data-trigger="focus"data-toggle="popover"data-placement="right" data-content="Pruebas realizadas para comprobar el buen funcionamiento luego de la intervención, ej: se realizaron 5 ciclos en vacío y dos com producto "></i></span>
                                        </div> 

                                        <textarea class="form-control" id="pruebas" th:field="*{pruebas}"></textarea>
                                        
                                         <div class="form-row">
                                            <div class="form-group col-md-6">
                                                <label for="materiales">materiales/repuestos</label>&nbsp;&nbsp;<span><i class="fa-regular fa-circle-question custom-popover" tabindex="0" data-container="body" data-trigger="focus"data-toggle="popover"data-placement="right" data-content="Títulos obtenidos (secundario, terciario, universitario), cursos, especializaciones, etc' "></i></span>
                                               <input type="text" class="form-control" id="materiales">
                                            </div>
                                        
                                            <div class="form-group col-md-6">
                                                <label for="estado">Estado final</label>
                                                <select class="form-control" id="estado"th:field="*{estadoFinal}"required="true">
                                                    <option value="reparado">reparado</option>
                                                    <option value="en observacion">en observación</option>
                                                    <option value="paliativo">paliativo</option>
                                                    <option value="irreparable">irreparable</option>
                                                </select>
                                            </div>
                                        </div>    
                                    <br>
                                        <h4 class="mt-4">Evaluación de causa raíz</h4>           
                                    <br>      
                                    <div class="form-row">
                                        <div class="form-group col-md-6">
                                            <label for="causaRaiz">Causa Raíz</label>&nbsp;&nbsp;<span><i class="fa-regular fa-circle-question custom-popover" tabindex="0" data-container="body" data-trigger="focus"data-toggle="popover"data-placement="right" data-content="Si está clara la causa raiz indiquela en este campo, de lo contrario apóyese de los siguientes campos para obtener una aproximación' "></i></span>
                                           <input type="text" class="form-control" id="causaRaiz" th:field="*{causaRaiz}">
                                        </div>
                                    </div>
                                    <div class="form-row">
                                         <div class="form-group col-md-6">    
                                            <label for="categoríaCausaRaiz">Categoría de la causa raíz</label>&nbsp;&nbsp;<span><i class="fa-regular fa-circle-question custom-popover" tabindex="0" data-container="body" data-trigger="focus"data-toggle="popover"data-placement="right" data-content="Humano /n técnico /n ambiental /n Organizacional /n suministros /n diseño /n operacional /n software /n formación/conocimientos /n comunicación /n económico/presupuestario /n Energía/suministro "></i></span>
                                           <input type="text" class="form-control" id="categoríaCausaRaiz" th:field="*{causaRaiz}">
                                        </div>
                                    </div>
                                        
                                        
                                        
                                    <label for="pregunta1">Pregunta 1</label>&nbsp;&nbsp;<span><i class="fa-regular fa-circle-question custom-popover" tabindex="0" data-container="body" data-trigger="focus"data-toggle="popover"data-placement="right" data-content=""></i></span>
                                    <input type="text" class="form-control" id="pregunta1" th:field="*{pregunta1}">

                                    <label for="pregunta2">Pregunta 2</label>&nbsp;&nbsp;<span><i class="fa-regular fa-circle-question custom-popover" tabindex="0" data-container="body" data-trigger="focus"data-toggle="popover"data-placement="right" data-content=""></i></span>
                                    <input type="text" class="form-control" id="pregunta2" th:field="*{pregunta2}">

                                    <label for="pregunta3">Pregunta 3</label>&nbsp;&nbsp;<span><i class="fa-regular fa-circle-question custom-popover" tabindex="0" data-container="body" data-trigger="focus"data-toggle="popover"data-placement="right" data-content=""></i></span>
                                    <input type="text" class="form-control" id="pregunta3" th:field="*{pregunta3}">

                                    <label for="pregunta4">Pregunta 4</label>&nbsp;&nbsp;<span><i class="fa-regular fa-circle-question custom-popover" tabindex="0" data-container="body" data-trigger="focus"data-toggle="popover"data-placement="right" data-content=""></i></span>
                                    <input type="text" class="form-control" id="pregunta4" th:field="*{pregunta4}">

                                    <label for="pregunta5">Pregunta 5</label>&nbsp;&nbsp;<span><i class="fa-regular fa-circle-question custom-popover" tabindex="0" data-container="body" data-trigger="focus"data-toggle="popover"data-placement="right" data-content=""></i></span>
                                    <input type="text" class="form-control" id="pregunta5" th:field="*{pregunta5}">
                                        
                                        
                                        
                                    <label for="seguimiento">Requiere seguimiento</label>&nbsp;&nbsp;<span><i class="fa-regular fa-circle-question custom-popover" tabindex="0" data-container="body" data-trigger="focus"data-toggle="popover"data-placement="right" data-content=""></i></span>
                                    <input type="text" class="form-control" id="seguimiento" th:field="*{seguimiento}">
                                  
                                    <label for="recomendaciones">Requiere seguimiento</label>&nbsp;&nbsp;<span><i class="fa-regular fa-circle-question custom-popover" tabindex="0" data-container="body" data-trigger="focus"data-toggle="popover"data-placement="right" data-content=""></i></span>
                                    <input type="text" class="form-control" id="recomendaciones" th:field="*{recomendaciones}">
                                        
                                        
                                    </form>
                                            </div>
                                    <section  class="py-4 mb-4 bg-light">
                                       <div class="container">
                                           <div class="row">
                                               <div class="col-md-2" >
                                                   <a th:href="@{/informes/}+${url}" class="btn btn-primary btn-block">
                                                        Volver
                                                   </a>
                                               </div>

                                           </div>
                                       </div>
                                   </section>

                                            </body>

                                          








                                            <script>
                                                var segundosRestantes = 120; // Define el tiempo inicial en segundos

                                                // Función para actualizar dinámicamente el tiempo restante y realizar la redirección
                                                function actualizarTiempoRestante() {
                                                    // Actualizar el contenido del span con el tiempo restante
                                                    document.getElementById('tiempoRestante').textContent = segundosRestantes;

                                                    // Disminuir el tiempo restante en 1 segundo
                                                    segundosRestantes--;

                                                    // Verificar si se alcanzó el tiempo límite
                                                    if (segundosRestantes < 0) {
                                                        // Realizar la redirección después de 60 segundos
                                                        window.location.href = '/';
                                                    } else {
                                                        // Llamar a esta función nuevamente después de 1 segundo
                                                        setTimeout(actualizarTiempoRestante, 1000); // 1000 milisegundos = 1 segundo
                                                    }
                                                }

                                                // Llamar a la función para iniciar el contador
                                                //            actualizarTiempoRestante();




                                            </script>


                                            <!--//para que funcione el popover-->
                                            <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
                                            </html>
